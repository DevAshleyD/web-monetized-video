const getStyle=(e="300",t="150")=>`\n    .err-msg {\n        display: flex;\n        justify-content: center;\n    }\n    .video-component {\n        width: ${e}px;\n        heigth: ${t}px;\n    }\n    `;class WebMonetizedVideo extends HTMLElement{constructor(){super(),console.log("constructor called!"),this.hasWebMonetizationEnabled=!1,this.onceWatchedFully=!1}isWebMonetized(){document.monetized?this.hasWebMonetizationEnabled=!0:this.hasWebMonetizationEnabled=!1}enableWebMonetization(){if(!this.hasWebMonetizationEnabled&&!this.onceWatchedFully){const e=document.createElement("meta");e.name="monetization",e.content=this.getPaymentDetails,document.head.appendChild(e),this.hasWebMonetizationEnabled=!0}}disableWebMonatization(){this.hasWebMonetizationEnabled=!1,document.querySelector('meta[name="monetization"]').remove()}connectedCallback(){this.createShadowRoot(),this.url=this.getAttribute("url"),this.width=this.getAttribute("width"),this.heigth=this.getAttribute("heigth"),this.getPaymentDetails=this.getAttribute("monetization-link"),this.isWebMonetized(),this.render()}render(){console.log("render called!");const e=document.createElement("video");e.setAttribute("id","video"),e.classList.add("video-component"),e.setAttribute("controls","controls"),this.shadowRoot.appendChild(e);const t=document.createElement("source");t.setAttribute("src",this.url),e.appendChild(t),this.addVideoEventListeners(e),this.addStyle()}addStyle(){const e=document.createElement("style");e.textContent=getStyle(this.width,this.heigth),this.shadowRoot.appendChild(e)}addVideoEventListeners(e){console.log("video listeners added!"),e.addEventListener("play",()=>{console.log("enable web monetization called"),this.enableWebMonetization(),this.webMonetizationEventListeners()}),e.addEventListener("pause",()=>{console.log("disable web monetization called"),this.disableWebMonatization()}),e.addEventListener("ratechange",()=>{console.log("You have increased or decreased the video speed you will be charged on the basis of how video viewed!")}),e.addEventListener("ended",()=>{this.disableWebMonatization(),this.onceWatchedFully=!0})}webMonetizationEventListeners(){console.log("hasWebMonetization",this.hasWebMonetizationEnabled),this.hasWebMonetizationEnabled&&(document.monetization.addEventListener("monetizationstop",this.checkMonetizationState()),document.monetization.addEventListener("monetizationstart",this.checkMonetizationState()),document.monetization.addEventListener("monetizationpending",this.checkMonetizationState()),document.monetization.addEventListener("monetizationprogress",this.checkMonetizationState()))}checkMonetizationState(e){"started"===document.monetization.state?this.calculateCharge(e):"pending"===document.monetization.state?console.log("Currently in Pending State. Will start shortly!"):"stopped"===document.monetization.state&&console.log(" Monetization is stopped!")}calculateCharge(e){let t;t=e.detail.assetScale,total+=Number(e.detail.amount);const n=(total*Math.pow(10,-t)).toFixed(t);console.log("Your total amount is ",n)}startEventHandler(e){console.log("event",e)}}try{customElements.define("web-monetized-video",WebMonetizedVideo)}catch(e){const t=document.createElement("h3");t.innerHTML="This site uses webcomponents which don't work in all browsers! Try this site in a browser that supports them!",document.body.appendChild(t)}